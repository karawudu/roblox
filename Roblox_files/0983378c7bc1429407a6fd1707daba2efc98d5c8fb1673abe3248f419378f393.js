!function(){"use strict";function y(){var e={retryable:!0,withCredentials:!0,url:"".concat(u,"/auth-token-service/v1/login/create")};return n.httpService.post(e).then(function(e){return e}).catch(function(e){return console.debug(e)})}function b(e){var t={retryable:!0,url:"".concat(u,"/auth-token-service/v1/login/status")};return n.httpService.post(t,e).then(function(e){return e}).catch(function(e){return console.debug(e)})}function E(e){var t={retryable:!0,url:"".concat(u,"/auth-token-service/v1/login/cancel")};return n.httpService.post(t,e).then(function(e){return e}).catch(function(e){return console.debug(e)})}function r(){y().then(function(e){e=e.data;"Created"===(null==e?void 0:e.status)&&(e=new CustomEvent("OpenCrossDeviceLoginDisplayCodeModal",{detail:{code:e.code,privateKey:e.privateKey,imagePath:e.imagePath}}),window.dispatchEvent(e))})}function p(){var e={retryable:!0,withCredentials:!0,url:"".concat(u,"/product-experimentation-platform/v1/projects/1/layers/Website.Login.CrossDeviceLogin.DisplayCode/values")},t={parameters:d.join(",")};return n.httpService.get(e,t).then(function(e){return null!=e&&e.data?e.data:Promise.reject()})}function h(){return n.httpService.get({retryable:!0,withCredentials:!0,url:"".concat(u,"/auth-token-service/v1/login/metadata")})}var a={n:function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},d:function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},n=CoreUtilities,w=React,S=a.n(w),t=ReactDOM,e=Roblox,i=a.n(e),o=PropTypes,c=a.n(o),l=ReactUtilities,s="crossDeviceLoginDisplayCode-container",x=CoreRobloxUtilities,g=ReactStyleGuide,u=e.EnvironmentUrls.apiGatewayUrl,d=["alt_title","alt_instruction","alt_device_specific_instruction"],v="https://en.help.roblox.com/hc/en-us/articles/360056582012";function m(e){var t=e.code,n=e.qrUrl,r=e.translate,a=e.altTitle,i=e.altInstruction,e=e.altDeviceSpecificInstruction,i=i||r("Label.LoginInstructions"),o=e?S().createElement("div",{className:"cross-device-login-device-specific-instruction-text font-caption-header",dangerouslySetInnerHTML:{__html:"".concat(i,"<br>").concat(e)}}):S().createElement("div",{className:"cross-device-login-instruction-text font-caption-header",dangerouslySetInnerHTML:{__html:"".concat(i,"<br>").concat(r("Label.LoginLocation"))}});return n?S().createElement("div",null,S().createElement("div",null,S().createElement("b",null,r("Label.QrHeader"))),S().createElement("img",{src:n,alt:"",className:"cross-device-login-display-qr-code-image"}),S().createElement("div",{className:"cross-device-login-instruction-text font-caption-header"},r("Label.QrInstructions"),S().createElement("br",null),S().createElement("a",{href:v,target:"_blank",rel:"noreferrer",className:"text-link cross-device-login-instruction-text"},S().createElement("u",null,r("Label.QrTroubleshooting")))),S().createElement("div",{className:"cross-device-login-qr-header-text"},S().createElement("b",null,r("Label.CodeHeader"))),S().createElement("div",{className:"font-title"},t),S().createElement("div",{className:"cross-device-login-instruction-text font-caption-header"},o)):S().createElement("div",null,S().createElement("div",{className:"cross-device-login-display-code-modal-image"}),S().createElement("div",{className:"font-title"},t),S().createElement("div",{className:"cross-device-login-device-prompt-text font-header-2"},a||r("Label.DevicePrompt")),S().createElement("div",{className:"cross-device-login-instruction-text font-caption-header"},o))}m.defaultProps={altTitle:"",altInstruction:"",altDeviceSpecificInstruction:""},m.propTypes={translate:c().func.isRequired,code:c().string.isRequired,qrUrl:c().string.isRequired,altTitle:c().string,altInstruction:c().string,altDeviceSpecificInstruction:c().string};var C=m;function f(e){var t=e.accountName,n=e.accountPictureUrl,e=e.translate;return S().createElement("div",null,S().createElement("div",null,n?S().createElement("img",{className:"cross-device-login-avatar-thumbnail",src:n,alt:"ph-avatar-headshot"}):S().createElement("div",{className:"cross-device-login-display-code-modal-image cross-device-login-ph-avatar-image"}),S().createElement("div",{className:"cross-device-login-device-prompt-text font-header-2"},e("Label.ConfirmOnDevice")),S().createElement("div",{className:"cross-device-login-instruction-text font-caption-header"},e("Label.WebLogginInAs")," ",S().createElement("span",null," ",t," "))))}f.propTypes={translate:c().func.isRequired,accountName:c().func.isRequired,accountPictureUrl:c().func.isRequired};var L=f;function N(e,t,n,r,a,i,o){try{var c=e[i](o),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e){var t=e.show,n=e.onHide,r=e.code,a=e.qrUrl,i=e.accountName,o=e.accountPictureUrl,c=e.translate,l=q((0,w.useState)(""),2),s=l[0],u=l[1],d=q((0,w.useState)(""),2),e=d[0],v=d[1],l=q((0,w.useState)(""),2),d=l[0],m=l[1];function f(){var c;return c=regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:if(null!=(n=e.sent)&&null!==(t=n.data)&&void 0!==t&&t.ShouldEnableCrossDeviceLoginInitiatorExperiments&&/^en\b/.test(navigator.language))return e.next=6,p();e.next=10;break;case 6:n=e.sent,u(null==n?void 0:n.alt_title),v(null==n?void 0:n.alt_instruction),m(null==n?void 0:n.alt_device_specific_instruction);case 10:case"end":return e.stop()}},e)}),(f=function(){var e=this,o=arguments;return new Promise(function(t,n){var r=c.apply(e,o);function a(e){N(r,t,n,a,i,"next",e)}function i(e){N(r,t,n,a,i,"throw",e)}a(void 0)})}).apply(this,arguments)}return(0,w.useEffect)(function(){return function(){return f.apply(this,arguments)}()},[]),S().createElement(g.Modal,{show:t,onHide:n,className:"cross-device-login-display-code-modal",size:"lg","aria-labelledby":"contained-modal-title-vcenter",scrollable:"true",centered:"true"},S().createElement(g.Modal.Header,{useBaseBootstrapComponent:!0},S().createElement("div",{className:"cross-device-login-display-code-modal-title-container"},S().createElement("button",{type:"button",className:"cross-device-login-display-code-modal-title-button",onClick:n},S().createElement("span",{className:"close icon-close"})),S().createElement(g.Modal.Title,{id:"contained-modal-title-vcenter"},c("Heading.LoginCode")))),S().createElement(g.Modal.Body,null,i?S().createElement(L,{accountName:i,accountPictureUrl:o,translate:c}):S().createElement(C,{code:r,qrUrl:a,translate:c,altTitle:s,altInstruction:e,altDeviceSpecificInstruction:d})))}P.propTypes={translate:c().func.isRequired,onHide:c().func.isRequired,show:c().bool.isRequired,code:c().string.isRequired,qrUrl:c().string.isRequired,accountName:c().string.isRequired,accountPictureUrl:c().string.isRequired};var U=P;function I(e){var t=e.code,n=e.qrUrl,e=e.translate;return S().createElement("div",{className:"cross-device-login-code-display"},S().createElement("div",{className:"alternative-login-divider-container"},S().createElement("div",{className:"rbx-divider alternative-login-divider"})),S().createElement("h2",null,e("Label.QrCodeLogin")),S().createElement("div",{className:"font-caption-header"},e("Label.QrInstructions"),S().createElement("div",{className:"font-caption-header cross-device-login-front-load-help-link"},S().createElement("a",{href:v,target:"_blank",rel:"noreferrer",className:"text-link cross-device-login-instruction-text"},S().createElement("u",null,e("Label.QrTroubleshooting"))))),S().createElement("img",{src:n,alt:"",className:"cross-device-login-display-qr-code-image"}),S().createElement("div",{className:"font-caption-header"},S().createElement("a",{href:"#",onClick:function(){E({code:t}),r()},className:"text-link"},e("Action.OpenAlphaNumericModal"))))}I.propTypes={code:c().string.isRequired,translate:c().func.isRequired,qrUrl:c().string.isRequired};var k=I,T={showModal:{name:"showModal",type:(o=x.eventStreamService.eventTypes).pageLoad,context:"crossDeviceKey"},showProfile:{name:"showProfile",type:o.pageLoad,context:"confirmPrompt"}};function D(e,t,n,r,a,i,o){try{var c=e[i](o),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function A(c){return function(){var e=this,o=arguments;return new Promise(function(t,n){var r=c.apply(e,o);function a(e){D(r,t,n,a,i,"next",e)}function i(e){D(r,t,n,a,i,"throw",e)}a(void 0)})}}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O=e.EnvironmentUrls.apiGatewayUrl;function j(e){function n(e){e&&u("".concat(O,"/auth-token-service").concat(e))}var t=e.isQrCodeFrontLoaded,r=e.translate,a=M((0,w.useState)(!1),2),i=a[0],o=a[1],c=M((0,w.useState)(""),2),l=c[0],s=c[1],e=M((0,w.useState)(""),2),a=e[0],u=e[1],c=M((0,w.useState)(""),2),d=c[0],v=c[1],e=M((0,w.useState)(""),2),m=e[0],f=e[1],c=M((0,w.useState)(""),2),e=c[0],p=c[1];window.addEventListener("OpenCrossDeviceLoginDisplayCodeModal",function(e){s(e.detail.code),v(e.detail.privateKey),n(e.detail.imagePath),x.eventStreamService.sendEventWithTarget(T.showModal.type,T.showModal.context,{}),o(!0)},!1);function h(e){return s(""),u(""),v(""),f(""),p(""),o(!1),t&&e&&g(),e?E({code:e}):null}var g=function(){var e=A(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:t=e.sent,t=t.data,s(t.code),v(t.privateKey),n(t.imagePath),f(""),p("");case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return(0,w.useEffect)(function(){var a=null;return l&&d?a=setInterval(A(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={code:l,privateKey:d},e.prev=1,e.next=4,b(t);case 4:if(r=e.sent,"Cancelled"===(null==(n=r.data)?void 0:n.status))return e.next=9,g();e.next=9;break;case 9:if("UserLinked"===(null==n?void 0:n.status)&&(""===m&&x.eventStreamService.sendEventWithTarget(T.showProfile.type,T.showProfile.context,{}),f(n.accountName||"unknown"),p(n.accountPictureUrl),o(!0)),"Validated"===(null==n?void 0:n.status))return r=new CustomEvent("OnCrossDeviceCodeValidated",{detail:{ctype:"AuthToken",code:l,privateKey:d}}),window.dispatchEvent(r),h(),e.abrupt("return",clearInterval(a));e.next=16;break;case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(1),e.next=22,g();case 22:return e.abrupt("return",!1);case 23:case"end":return e.stop()}},e,null,[[1,18]])})),5e3):t&&!(l||d)&&g(),function(){return clearInterval(a)}},[m,l,d,t]),S().createElement("div",null,S().createElement(U,{show:i,code:l,qrUrl:!t&&a,accountName:m,accountPictureUrl:e,onHide:function(){return h(l)},translate:r}),t&&S().createElement(k,{code:l,qrUrl:a,translate:r}))}j.propTypes={isQrCodeFrontLoaded:c().bool.isRequired,translate:c().func.isRequired};var Q=j;function H(e){var t=e.isQrCodeFrontLoaded,e=e.translate;return S().createElement(Q,{isQrCodeFrontLoaded:t,translate:e})}H.propTypes={isQrCodeFrontLoaded:c().bool.isRequired,translate:c().func.isRequired};var F=(0,l.withTranslations)(H,{common:[],feature:"Authentication.CrossDevice"});i().CrossDeviceLoginDisplayCodeService={openModal:r};var K=function(e){return null===e.getAttribute("data-frontload-qr-code")},B=function(e){return"true"===e.getAttribute("data-frontload-qr-code").toString()};function W(){var e=document.getElementById(s);e&&!K(e)?(0,t.render)(S().createElement(F,{isQrCodeFrontLoaded:B(e)}),e):window.requestAnimationFrame(W)}(0,n.ready)(function(){W()})}();
//# sourceMappingURL=https://js.rbxcdn.com/ed6f5c9a8932a1336c9f-crossDeviceLoginDisplayCodeModal.bundle.min.js.map

/* Bundle detector */
window.Roblox && window.Roblox.BundleDetector && window.Roblox.BundleDetector.bundleDetected("CrossDeviceLoginDisplayCode");